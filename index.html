

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Welcome to ArxPy’s documentation! &mdash; ArxPy 0.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="arxpy package" href="arxpy.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> ArxPy
          

          
          </a>

          
            
            
              <div class="version">
                0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="arxpy.html">arxpy package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">ArxPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>Welcome to ArxPy’s documentation!</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="welcome-to-arxpy-s-documentation">
<h1>Welcome to ArxPy’s documentation!<a class="headerlink" href="#welcome-to-arxpy-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="arxpy-0-3">
<h2>ArxPy 0.3<a class="headerlink" href="#arxpy-0-3" title="Permalink to this headline">¶</a></h2>
<p>ArxPy is a python3 library to find XOR differential characteristics,
rotational-XOR characteristics, and impossible differentials
in ARX primitives (e.g., block ciphers) using SMT solvers.</p>
<p>ArxPy implements, improves and unifies the SMT-based methods of the following papers:</p>
<ul class="simple">
<li><p>Towards Finding Optimal Differential Characteristics for ARX: Application to Salsa20</p></li>
<li><p>Observations on the SIMON Block Cipher Family</p></li>
<li><p>An Easy-to-Use Tool for Rotational-XOR Cryptanalysis of ARX Block Ciphers</p></li>
<li><p>Rotational-XOR Cryptanalysis of Reduced-round SPECK</p></li>
<li><p>A Bit-Vector Differential Model for the Modular Addition by a Constant</p></li>
</ul>
<p>ArxPy provides a complete documentation and an extensive suite of tests.</p>
</div>
</div>
<div class="section" id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h1>
<p>First, the ARX cipher needs to be implemented following ArxPy interface.
There are several ARX ciphers implemented already (see the folder <code class="xref any docutils literal notranslate"><span class="pre">arxpy/primitives</span></code>).
To implemented a new cipher, the easiest way is to take a similar cipher
already implemented as a template and modify the python code directly.</p>
<p>Searching the optimal XOR differential characteristic can be done easily with
the function <a class="reference internal" href="arxpy.smt.search_differential.html#arxpy.smt.search_differential.round_based_search_SkCh" title="arxpy.smt.search_differential.round_based_search_SkCh"><code class="xref any py py-func docutils literal notranslate"><span class="pre">round_based_search_SkCh()</span></code></a>. For example, searching for the best
2-round and 3-round differential characteristics of Speck32_64 can be done as follows</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">arxpy.differential.difference</span> <span class="kn">import</span> <span class="n">XorDiff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">arxpy.smt.search_differential</span> <span class="kn">import</span> <span class="n">SkChSearchMode</span><span class="p">,</span> <span class="n">DerMode</span><span class="p">,</span> <span class="n">round_based_search_SkCh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">arxpy.primitives</span> <span class="kn">import</span> <span class="n">speck</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cipher</span> <span class="o">=</span> <span class="n">speck</span><span class="o">.</span><span class="n">get_Speck_instance</span><span class="p">(</span><span class="n">speck</span><span class="o">.</span><span class="n">SpeckInstance</span><span class="o">.</span><span class="n">speck_32_64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start_rounds</span><span class="p">,</span> <span class="n">end_rounds</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_based_search_SkCh</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span> <span class="n">XorDiff</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;btor&quot;</span><span class="p">,</span> <span class="n">start_rounds</span><span class="p">,</span> <span class="n">end_rounds</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">DerMode</span><span class="o">.</span><span class="n">Default</span><span class="p">,</span> <span class="n">SkChSearchMode</span><span class="o">.</span><span class="n">Optimal</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">Num rounds: 4</span>
<span class="go">Best characteristic found:</span>
<span class="go">(weight 5) 2800 0010 -&gt; 8000 840a</span>

<span class="go">Num rounds: 5</span>
<span class="go">Best characteristic found:</span>
<span class="go">(weight 9) 0211 0a04 -&gt; 8000 840a</span>
</pre></div>
</div>
<p>Apart from the cipher and the number of rounds to search, the function
<a class="reference internal" href="arxpy.smt.search_differential.html#arxpy.smt.search_differential.round_based_search_SkCh" title="arxpy.smt.search_differential.round_based_search_SkCh"><code class="xref any py py-func docutils literal notranslate"><span class="pre">round_based_search_SkCh()</span></code></a> has several parameters to adapt the search as needed.
For example, by changing <code class="xref any docutils literal notranslate"><span class="pre">verbose_lvl`to</span> <span class="pre">`1</span></code> it is shown the intermediate
differences of the found characteristic and the weights of the non-linear operations.
This function stores each characteristic found as a <a class="reference internal" href="arxpy.smt.search_differential.html#arxpy.smt.search_differential.ChFound" title="arxpy.smt.search_differential.ChFound"><code class="xref any py py-class docutils literal notranslate"><span class="pre">ChFound</span></code></a> object.
The explanation of these paremeters and the attributes of <a class="reference internal" href="arxpy.smt.search_differential.html#arxpy.smt.search_differential.ChFound" title="arxpy.smt.search_differential.ChFound"><code class="xref any py py-class docutils literal notranslate"><span class="pre">ChFound</span></code></a> objects
can be found in the documentation.
Every function and class in ArxPy is documented with a description of
the object and with doctests!</p>
<p>If the argument <code class="xref any docutils literal notranslate"><span class="pre">check</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref any docutils literal notranslate"><span class="pre">True</span></code></a> in <a class="reference internal" href="arxpy.smt.search_differential.html#arxpy.smt.search_differential.round_based_search_SkCh" title="arxpy.smt.search_differential.round_based_search_SkCh"><code class="xref any py py-func docutils literal notranslate"><span class="pre">round_based_search_SkCh()</span></code></a>, the
weight of each characteristic found is checked by computing the empirical
weight (by sampling many plaintexts and keys and computing the
differential probability manually). This is useful since for
ARX ciphers the theoretical weight and the actual weight might differ
in some cases.</p>
<p>Searching the optimal related-key XOR differential characteristic can be done
in a similar way with the function <a class="reference internal" href="arxpy.smt.search_differential.html#arxpy.smt.search_differential.round_based_search_RkCh" title="arxpy.smt.search_differential.round_based_search_RkCh"><code class="xref any py py-func docutils literal notranslate"><span class="pre">round_based_search_RkCh()</span></code></a>. For example,
searching for the best 4-round and 5-round related-key characteristics of
XTEA can be done as follows (this can take some minutes)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">arxpy.differential.difference</span> <span class="kn">import</span> <span class="n">XorDiff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">arxpy.smt.search_differential</span> <span class="kn">import</span> <span class="n">RkChSearchMode</span><span class="p">,</span> <span class="n">DerMode</span><span class="p">,</span> <span class="n">round_based_search_RkCh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">arxpy.primitives.xtea</span> <span class="kn">import</span> <span class="n">XteaCipher</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cipher</span> <span class="o">=</span> <span class="n">XteaCipher</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_based_search_RkCh</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span> <span class="n">XorDiff</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;btor&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">DerMode</span><span class="o">.</span><span class="n">Default</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">DerMode</span><span class="o">.</span><span class="n">Default</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">RkChSearchMode</span><span class="o">.</span><span class="n">OptimalMinSum</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">Num rounds: 4</span>
<span class="go">Best related-key characteristic found:</span>
<span class="go">E: (weight 0) 80000000 00000000 -&gt; 00000000 80000000 | K: (weight 0) 80000000 00000000 80000000 00000000 -&gt; 80000000 00000000 00000000 80000000</span>

<span class="go">Num rounds: 5</span>
<span class="go">Best related-key characteristic found:</span>
<span class="go">E: (weight 0) 80000000 00000000 -&gt; 00000000 00000000 | K: (weight 0) 80000000 00000000 00000000 00000000 -&gt; 80000000 00000000 00000000 00000000 00000000</span>
</pre></div>
</div>
<p>A related-key characteristic is split into two characteristics, one
describing the propagation of differences through the key schedule
(‘key_ch_found’) and another one describing the propagation of
differences through the encryption function (‘enc_ch_found’).</p>
<p>To search for rotational-XOR characteristics, the same functions
<a class="reference internal" href="arxpy.smt.search_differential.html#arxpy.smt.search_differential.round_based_search_SkCh" title="arxpy.smt.search_differential.round_based_search_SkCh"><code class="xref any py py-func docutils literal notranslate"><span class="pre">round_based_search_SkCh()</span></code></a> and <a class="reference internal" href="arxpy.smt.search_differential.html#arxpy.smt.search_differential.round_based_search_RkCh" title="arxpy.smt.search_differential.round_based_search_RkCh"><code class="xref any py py-func docutils literal notranslate"><span class="pre">round_based_search_RkCh()</span></code></a> can be used
but using  <a class="reference internal" href="arxpy.differential.difference.html#arxpy.differential.difference.RXDiff" title="arxpy.differential.difference.RXDiff"><code class="xref any py py-class docutils literal notranslate"><span class="pre">RXDiff</span></code></a> as the <code class="xref any docutils literal notranslate"><span class="pre">difference_type</span></code> argument. For example,
searching for 4-round and 5-round rotational-XOR differential characteristics
of CHAM_64_128 can be done in the following way</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">arxpy.differential.difference</span> <span class="kn">import</span> <span class="n">RXDiff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">arxpy.smt.search_differential</span> <span class="kn">import</span> <span class="n">RkChSearchMode</span><span class="p">,</span> <span class="n">DerMode</span><span class="p">,</span> <span class="n">round_based_search_RkCh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">arxpy.primitives</span> <span class="kn">import</span> <span class="n">cham</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cipher</span> <span class="o">=</span> <span class="n">cham</span><span class="o">.</span><span class="n">get_Cham_instance</span><span class="p">(</span><span class="n">cham</span><span class="o">.</span><span class="n">ChamInstance</span><span class="o">.</span><span class="n">cham_64_128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_based_search_RkCh</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span> <span class="n">RXDiff</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;btor&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">DerMode</span><span class="o">.</span><span class="n">Default</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">DerMode</span><span class="o">.</span><span class="n">Default</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">RkChSearchMode</span><span class="o">.</span><span class="n">FirstMinSumValid</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">Num rounds: 4</span>
<span class="go">Best related-key characteristic found:</span>
<span class="go">E: (weight 5) 8000 0002 8006 0004 -&gt; 0100 0001 0080 0001 | K: (weight 0) 6123 0281 c246 6020 8000 8000 8000 8000 -&gt; 8004 8681 0009 8000</span>

<span class="go">Num rounds: 5</span>
<span class="go">Best related-key characteristic found:</span>
<span class="go">E: (weight 8) 0000 0002 8007 0005 -&gt; 0002 0000 0000 0000 | K: (weight 0) 0202 2261 22e7 0503 0103 8000 8000 8000 -&gt; 0404 0781 800b 0c00 0004</span>
</pre></div>
</div>
<p>While there is no tutorial to learn how to use ArxPy yet,
the doctests and doctstrings from <code class="xref any docutils literal notranslate"><span class="pre">arxpy/smt/search.py</span></code> provides
plenty of information and examples of searching characteristics.</p>
</div>
<div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p>ArxPy requires python3 (&gt;= 3.7) and the following python libraries:</p>
<ul class="simple">
<li><p>cython</p></li>
<li><p>sympy</p></li>
<li><p>bidict</p></li>
<li><p>cffi</p></li>
<li><p>pySMT</p></li>
</ul>
<p>These libraries can be easily installed with pip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">cython</span> <span class="n">sympy</span> <span class="n">bidict</span> <span class="n">cffi</span> <span class="n">pysmt</span>
</pre></div>
</div>
<p>ArxPy also requires an SMT solver supporting the bit-vector theory,
installed through <a class="reference external" href="https://pysmt.readthedocs.io/en/latest/getting_started.html#getting-started">pySMT</a>.
We recommend boolector.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pysmt</span><span class="o">-</span><span class="n">install</span> <span class="o">--</span><span class="n">btor</span>
</pre></div>
</div>
<p>Optionally, hypothesis and yices can be installed to run the tests,
and sphinx and sphinx-rtd-theme to build the documentation.</p>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="arxpy.html">arxpy package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="arxpy.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="arxpy.bitvector.html">arxpy.bitvector package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="arxpy.bitvector.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="arxpy.differential.html">arxpy.differential package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="arxpy.differential.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="arxpy.primitives.html">arxpy.primitives package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="arxpy.primitives.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="arxpy.smt.html">arxpy.smt package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="arxpy.smt.html#submodules">Submodules</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="arxpy.html" class="btn btn-neutral float-right" title="arxpy package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Adrián Ranea

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>